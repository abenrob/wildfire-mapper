<!DOCTYPE html>
<html>
<head>
  <title>Wildfires | US</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet"
    href="http://cdn.leafletjs.com/leaflet-0.6.2/leaflet.css" />
  <!--[if lte IE 8]>
    <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.4/leaflet.ie.css" />
  <![endif]-->
  <link rel="stylesheet" href="styles.css" />
  <link rel="stylesheet" href="MarkerCluster.css" />
  <link rel="stylesheet" href="MarkerCluster.Default.css" />
  <!--[if lte IE 8]><link rel="stylesheet" href="markercluster/MarkerCluster.Default.ie.css" /><![endif]-->
  <link rel="points" href="fires.geojson"/>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js">
  </script>
  <script>
  $(document).ready(function(){
    $("#sidebar-off").click(function(){
    $("#infoback").hide('slow');
    });
    $("#sidebar-on").click(function(){
    $("#infoback").show('slow');
    });
  });
  </script>
</head>
<body>
  <div id="map"></div>
  <div id='collapse'>
    <div class="switch switch-yellow">
      <input type="radio" class="switch-input" name="view3" value="sidebar-on" id="sidebar-on" checked>
      <label for="sidebar-on" class="switch-label switch-label-off">Show</label>

      <input type="radio" class="switch-input" name="view3" value="sidebar-off" id="sidebar-off">
      <label for="sidebar-off" class="switch-label switch-label-on">Hide</label>
      <span class="switch-selection"></span>
    </div>
  </div>
  <div id='infoback'>
    <div id='info'>
    <h1>US Wildfires</h1>
    <strong>2013-27-08 Source: <a href="http://activefiremaps.fs.fed.us/lg_fire2.php#">Active Fire Mapping Program</a>.</strong>
  
    <p>
      These data points represent current large fire incidents in the United States. Data are from the <a href="http://activefiremaps.fs.fed.us/">Active Fire Mapping Program</a> at the US Forest Service. Individual points are shown while clusters of points are represented with a circle and the number of fires close to each other. Hovering over the clustered points will show the bounds of the points while clicking on them will zoom you in to their extents.
    </p>
    <p>
      The hope is to keep this up to date with new publishings from the Forest Service. The basemaps being used are from <a href="http://mapbox.com">Mapbox</a> and the mapping javascript library is <a href="http://leafletjs.com">Leaflet</a>. 
    </p>
    <p class="disclaimer">
      The information on this map was derived from USFS. Grafa cannot accept any responsibility for errors, omissions, or positional accuracy. There are no warranties, expressed or implied, including the warranty of merchantability or fitness for a particular purpose, accompanying this product. However, notification of any errors will be appreciated.
    </p></div>
  </div>
  <script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
  <script src="http://cdn.leafletjs.com/leaflet-0.6.2/leaflet.js"></script>
  <script src="leaflet.markercluster.js"></script>
  <script>
    var terrain = L.tileLayer(
      'http://api.tiles.mapbox.com/v3/grafa.map-8cndm7h3/{z}/{x}/{y}.png', {
        attribution: "<a href='http://mapbox.com'>Mapbox</a>"
        });

    var streets = L.tileLayer(
      'http://api.tiles.mapbox.com/v3/grafa.map-omtiruqb/{z}/{x}/{y}.png', {
        attribution: "<a href='http://mapbox.com'>Mapbox</a>"
        });

  var fireIcon = L.icon({
      iconUrl: 'fire.png'
    });

  function onEachFeature(feature, layer) {
    layer.bindPopup('<h2>' + feature.properties.fire_name + '</h2>' + '<br />' + 
      '<strong>Fire Number: </strong>' + feature.properties.fire_number + '<br />' + 
      '<strong>Acres Burned: </strong>' + feature.properties.area + '<br />' + 
      '<strong>Report Date: </strong>' + feature.properties.report_date
      );
  }

  /* Load points GeoJSON and add to map */
  $.getJSON($('link[rel="points"]').attr("href"), function(data) {
    var geojson = L.geoJson(data, {

      pointToLayer: function (feature, latlng) {
        return L.marker(latlng, {icon: fireIcon});
      },

      onEachFeature: onEachFeature
   });
    var map = L.map('map').fitBounds(geojson.getBounds());
    terrain.addTo(map);
    L.control.layers({
      "Terrain (default)": terrain,
      "Mapbox Streets": streets
      }).addTo(map);

    var markers = L.markerClusterGroup();

    markers.addLayer(geojson);
    map.addLayer(markers);
  });

  </script>
</body>
</html>
